<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.togest.dao.MileageStatisticsDao">
	<resultMap id="BaseResultMap" type="com.togest.domain.MileageStatisticsDTO">
		<id column="id" property="id" />
		<result column="statistics_date" property="statisticsDate" />
		<result column="equ_num" property="equNum" />
		<result column="line_id" property="lineId" />
		<result column="mileage" jdbcType="DECIMAL" property="mileage" />
		<result column="alarm_num" jdbcType="INTEGER" property="alarmNum" />
		<result column="section_id" property="sectionId" />
		<result column="sort" property="sort" />
		<result column="lineName" property="lineName" />
		<result column="sectionName" property="sectionName" />
	</resultMap>

	<sql id="Base_Column_List">
		ms.id, ms.statistics_date, ms.equ_num, ms.line_id, ms.mileage, ms.alarm_num,
		ms.section_id, ms.sort, pl.name as lineName, pd.name as sectionName
	</sql>
	<sql id="Base_Condition">
		<if test="startDate != null">
			and ms.statistics_date &gt;= #{startDate}
		</if>
		<if test="endDate != null">
			and ms.statistics_date &lt;= #{endDate}
		</if>
		<if test="equNum != null">
			and ms.equ_num = #{equNum}
		</if>
		<if test="lineId != null">
			and ms.line_id = #{lineId}
		</if>
		<if test="mileage != null">
			and ms.mileage = #{mileage}
		</if>
		<if test="alarmNum != null">
			and ms.alarm_num = #{alarmNum}
		</if>
		<if test="sectionId != null">
			and ms.section_id = #{sectionId}
		</if>
	</sql>
	
	<sql id="BASE_TABLE">
		from 6c_mileage_statistics ms
		left join p_line pl on pl.id = ms.line_id
		left join p_department pd on pd.id = ms.section_id
	</sql>

	<select id="findList" parameterType="com.togest.request.MileageStatisticsRequest"
		resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		<include refid="BASE_TABLE" />
		<where>
		ms.del_flag=0
		<include refid="Base_Condition" />
		</where>
		order by ms.statistics_date desc
	</select>
	<select id="getByEntity" parameterType="com.togest.domain.MileageStatisticsDTO"
		resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		<include refid="BASE_TABLE" />
		<where>
		ms.del_flag=0
		<if test="statisticsDate != null">
			and ms.statistics_date = #{statisticsDate}
		</if>
		<if test="equNum != null">
			and ms.equ_num = #{equNum}
		</if>
		<if test="lineId != null">
			and ms.line_id = #{lineId}
		</if>
		<if test="mileage != null">
			and ms.mileage = #{mileage}
		</if>
		<if test="alarmNum != null">
			and ms.alarm_num = #{alarmNum}
		</if>
		<if test="sectionId != null">
			and ms.section_id = #{sectionId}
		</if>
		</where>
	</select>
	
	<select id="getByKey" parameterType="java.lang.String"
		resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		<include refid="BASE_TABLE" />
		where ms.id = #{id}
	</select>
	
	<insert id="insert" parameterType="com.togest.domain.MileageStatisticsDTO">
		insert into
		6c_mileage_statistics (id, statistics_date, equ_num,
		line_id, mileage,
		alarm_num,
		section_id, del_flag, create_ip,
		create_by, create_date,sort
		)
		values (#{id}, #{statisticsDate},
		#{equNum},
		#{lineId}, #{mileage},
		#{alarmNum},
		#{sectionId}, #{delFlag},
		#{createIp},
		#{createBy},
		#{createDate}, #{sort}
		)
	</insert>
	
	<update id="update" parameterType="com.togest.domain.MileageStatisticsDTO">
		update 6c_mileage_statistics
		set statistics_date = #{statisticsDate},
		equ_num = #{equNum},
		line_id = #{lineId},
		mileage = #{mileage},
		alarm_num = #{alarmNum},
		section_id = #{sectionId},
		update_ip = #{updateIp},
		update_by = #{updateBy},
		update_date = #{updateDate},
		sort = #{sort}
		where id = #{id}
	</update>
	
	<update id="deleteFalse" parameterType="com.togest.domain.MileageStatisticsDTO">
		update 6c_mileage_statistics
		set 
		del_flag = 1,
		delete_ip = #{deleteIp},
		delete_by = #{deleteBy},
		delete_date = #{deleteDate}
		where id = #{id}
	</update>
	
	<update id="deleteFalses" parameterType="java.util.Map">
		update 6c_mileage_statistics
		set 
		del_flag = 1,
		delete_ip = #{deleteIp},
		delete_by = #{deleteBy},
		delete_date = #{deleteDate}
		where id in
		<foreach item="item" collection="ids" separator="," open="("
			close=")" index="">
			#{item}
		</foreach>
	</update>
</mapper>