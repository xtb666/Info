<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.togest.dao.MetadataDao">

    <resultMap type="com.togest.domain.Metadata" id="MetadataMap">
		<result property="id" column="id"/>
		<result property="name" column="name"/>
		<result property="type" column="type"/>
		<result property="code" column="code"/>
		<result property="systemId" column="system_id"/>
		<result property="uploader" column="uploader"/>
		<result property="uploadDate" column="upload_date"/>
		<result property="data" column="data"/>
		<result property="data" column="data"/>
		<result property="fileId" column="file_id"/>
		<result property="fileName" column="file_name"/>
		<result property="remark" column="remark"/>
		<result property="sort" column="sort"/>
		<result property="delFlag" column="del_flag"/>
		<result property="createBy" column="create_by"/>
		<result property="createDate" column="create_date"/>
		<result property="createIp" column="create_ip"/>
		<result property="updateBy" column="update_by"/>
		<result property="updateDate" column="update_date"/>
		<result property="updateIp" column="update_ip"/>
		<result property="deleteBy" column="delete_by"/>
		<result property="deleteDate" column="delete_date"/>
		<result property="deleteIp" column="delete_ip"/>
    </resultMap>
    
    <sql id="baseColumns">
    	id,
    	name,
    	type,
    	code,
    	system_id,
    	uploader,
    	upload_date,
    	data,
    	file_id,
		file_name,
    	remark,
    	sort,
    	del_flag
    </sql>
    
    <sql id="baseConditions">
		<if test="name != null"> 
			and name like '%${name}%'
		</if>
		<if test="type != null"> 
			and type = #{type}
		</if>
		<if test="code != null"> 
			and code = #{code}
		</if>
		<if test="systemId != null"> 
			and system_id = #{systemId}
		</if>
		<if test="uploader != null"> 
			and uploader = #{uploader}
		</if>
		<if test="uploadDate != null"> 
			and upload_date = #{uploadDate}
		</if>
		<if test="data != null"> 
			and data = #{data}
		</if>
		<if test="fileId != null"> 
			and file_id = #{fileId}
		</if>
		<if test="fileName != null"> 
			and file_name = #{fileName}
		</if>
		<if test="remark != null"> 
			and remark = #{remark}
		</if>
		<!-- <if test="delFlag != null"> 
			and del_flag = #{delFlag}
		</if> -->
    </sql>

	<select id="getByKey" parameterType="java.lang.String" resultMap="MetadataMap">
		select <include refid="baseColumns"></include>
		from 6c_metadata
		where id = #{id} and del_flag = 0
	</select>
	
	<select id="getListByKeys" parameterType="java.util.List" resultMap="MetadataMap">
		select <include refid="baseColumns"></include>
		from 6c_metadata
		where id in
		<foreach item="item" collection="ids" separator="," open="("
					close=")" index="">
					#{item}
		</foreach>
		and del_flag = 0
	</select>
	
	<select id="getByEntity" parameterType="com.togest.domain.Metadata" resultMap="MetadataMap">
		select <include refid="baseColumns"></include>
		from 6c_metadata
		<where>
			<include refid="baseConditions"></include>
			and del_flag = 0
		</where>
		
	</select>
	<select id="findAllList" parameterType="com.togest.domain.Metadata" resultMap="MetadataMap">
		select <include refid="baseColumns"></include>
		from 6c_metadata
		where del_flag = 0 
		order by upload_date desc
	</select>
	<select id="findList" parameterType="com.togest.domain.Metadata" resultMap="MetadataMap">
		select <include refid="baseColumns"></include>
		from 6c_metadata
		<where>
			<if test="beginCheckDate != null">
				create_date &gt;= #{beginCheckDate}
			</if>
			<if test="endCheckDate != null">
				and create_date &lt;= #{endCheckDate}
			</if>
			<if test="name != null"> 
			and name like '%${name}%'
		</if>
		<if test="type != null"> 
			and type = #{type}
		</if>
		<if test="code != null"> 
			and code in 
			<foreach item="item" collection="code.split(',')" separator="," open="("
					close=")">
					#{item}
		</foreach>
		</if>
		<if test="systemId != null"> 
			and system_id = #{systemId}
		</if>
		<if test="uploader != null"> 
			and uploader = #{uploader}
		</if>
		<if test="uploadDate != null"> 
			and upload_date = #{uploadDate}
		</if>
		<if test="data != null"> 
			and data = #{data}
		</if>
		<if test="fileId != null"> 
			and file_id = #{fileId}
		</if>
		<if test="fileName != null"> 
			and file_name = #{fileName}
		</if>
		<if test="remark != null"> 
			and remark = #{remark}
		</if>
			and del_flag = 0
			<choose>
            <when test="orderBy!=null and orderBy!=''">
                order by ${orderBy}
            </when>
			<otherwise>
           		order by upload_date desc
			</otherwise>
        </choose>
		</where>
	</select>
	 
	<insert id="insert" parameterType="com.togest.domain.Metadata">
		insert into 6c_metadata
		<trim prefix="(" suffix=")" suffixOverrides="," >
            id,
            name,
            type,
            code,
            system_id,
            uploader,
            upload_date,
            data,
            file_id,
            file_Name,
            remark,
            del_flag,
            create_by,
            create_date,
            create_ip,
			<if test="sort!=null">sort</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides="," >
			#{id},
			#{name},
			#{type},
			#{code},
			#{systemId},
			#{uploader},
			#{uploadDate},
			#{data},
			#{fileId},
			#{fileName},
			#{remark},
			#{delFlag},
			#{createBy},
			#{createDate},
			#{createIp},
			<if test="sort!=null">#{sort}</if>
		</trim>
	</insert>
	 
	<update id="update" parameterType="com.togest.domain.Metadata">
		update 6c_metadata 
		<set >
		<if test="name != null"> 
		name = #{name},
		</if>
		<if test="type != null"> 
		type = #{type},
		</if>
		<if test="code != null"> 
		code = #{code},
		</if>
		<if test="systemId != null"> 
		system_id = #{systemId},
		</if>
		<if test="uploader != null"> 
		uploader = #{uploader},
		</if>
		<if test="uploadDate != null"> 
		upload_date = #{uploadDate},
		</if>
		<if test="data != null"> 
		data = #{data},
		</if>
		<if test="fileId != null"> 
		file_id = #{fileId},
		</if>
		<if test="fileName != null"> 
		file_name = #{fileName},
		</if>
		<if test="remark != null"> 
		remark = #{remark},
		</if>
		<if test="updateBy != null"> 
		update_by = #{updateBy},
		</if>
		<if test="updateDate != null"> 
		update_date = #{updateDate},
		</if>
		<if test="updateIp != null"> 
		update_ip = #{updateIp},
		</if>
		<!-- <if test="delFlag != null"> 
		del_flag = #{delFlag},
		</if> -->
		<if test="createBy != null"> 
		create_by = #{createBy},
		</if>
		<if test="createDate != null"> 
		create_date = #{createDate},
		</if>
		<if test="createIp != null"> 
		create_ip = #{createIp},
		</if>
		<if test="updateBy != null"> 
		update_by = #{updateBy},
		</if>
		<if test="updateDate != null"> 
		update_date = #{updateDate},
		</if>
		<if test="updateIp != null"> 
		update_ip = #{updateIp},
		</if>
		</set >
		where id = #{id}  and del_flag = 0
	</update>

	<update id="delete" parameterType="com.togest.domain.Metadata">
		update 6c_metadata
		set del_flag=1,delete_by=#{deleteBy},delete_date=#{deleteDate},delete_ip=#{deleteIp}
		where 
		id in 
		<foreach item="item" collection="id.split(',')" separator="," open="("
					close=")">
					#{item}
		</foreach>
	</update>
	<update id="deleteFalses" parameterType="java.util.List">
		update 6c_metadata set
		del_flag=1,delete_ip = #{deleteIp},delete_by=#{deleteBy},delete_date=current_timestamp
		where id
		in
			<foreach item="item" collection="ids" separator="," open="("	close=")">
					#{item}
			</foreach>
	</update>
	<update id="deleteFalse" parameterType="com.togest.domain.Metadata">
	update 6c_metadata set
		del_flag=1,delete_ip = #{deleteIp},delete_by=#{deleteBy},delete_date=current_timestamp
		<where>
			<include refid="baseConditions"></include>
		</where>
	</update>
	<delete id="deleteByKey" parameterType="java.lang.String" >
		delete from 6c_metadata
		where id = #{id}
	</delete>
	<delete id="deleteByEntity" parameterType="com.togest.domain.Metadata" >
		delete from 6c_metadata
		<where>
			<include refid="baseConditions"></include>
		</where>
	</delete>

</mapper>